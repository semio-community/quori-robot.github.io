import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.CC6F48bw.js";import{E as b}from"./EventCard.DXUt0jvj.js";import{S as D}from"./Section.wZSHqIv0.js";import"./images.CjpKPGZ8.js";import"./url.Cps14vuW.js";import"./clsx.D-yZXX6k.js";import"./SettingsMinimalistic.Cu3kf_IX.js";import"./links.CXE4DbFT.js";import"./index.C75oz_-d.js";import"./index.CdzOqBcL.js";import"./index.Bj0MOu0U.js";import"./SquareAcademicCap.VMa2rgey.js";import"./CpuBolt.C09Z8HUO.js";import"./TestTube.0bI1nbDD.js";import"./site.config.CPly3Mom.js";import"./Calendar.D7ektZzO.js";const T=({items:m,initialCount:p,viewAllText:v,renderItem:j})=>{const[r,o]=c.useState(!1),s=c.useRef(null),f=c.useRef(!1),l=c.useRef(r);return c.useEffect(()=>{if(!f.current){f.current=!0,l.current=r;return}if(l.current&&!r&&s.current){const i=s.current.getBoundingClientRect().top+window.scrollY-100;window.scrollTo({top:i,behavior:"smooth"})}l.current=r},[r]),a.jsxs("div",{ref:s,"data-expandable-section":!0,"data-initial-count":p.toString(),children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6","data-items-container":!0,children:m.map((i,u)=>a.jsx("div",{"data-expandable-item":!0,"data-index":u,className:u>=p&&!r?"hidden":"",children:j(i,u)},i.id??u))}),m.length>p&&a.jsx("div",{className:"text-center mt-6",children:a.jsxs("button",{"data-expand-button":!0,onClick:()=>o(i=>!i),className:"inline-flex items-center gap-2 px-6 py-3 bg-accent-base/10 hover:bg-accent-base/20 rounded-lg font-medium text-accent-base transition-all",children:[a.jsx("span",{"data-expand-text":!0,className:r?"hidden":"",children:v}),a.jsx("span",{"data-collapse-text":!0,className:r?"":"hidden",children:"Show Less"}),a.jsx("svg",{className:"w-4 h-4 transition-transform","data-expand-icon":!0,style:{transform:r?"rotate(180deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 15l-4-4h8l-4 4z",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]})},q=({eventsPayload:m,initialFeaturedCount:p=6,initialPastCount:v=6,className:j})=>{const r=c.useMemo(()=>JSON.parse(m),[m]),o=c.useMemo(()=>new Date,[]),s=e=>e?e instanceof Date?e:new Date(e):void 0,f=e=>{const d=s(e.data.startDate),x=s(e.data.endDate)??d;return o>x?"past":o>=d&&o<=x?"ongoing":"upcoming"},l=e=>({...e,data:{...e.data,startDate:s(e.data.startDate),endDate:s(e.data.endDate)}}),{featuredEvents:i,upcomingEvents:u,pastEvents:w,upcomingByYear:N}=c.useMemo(()=>{const e=r.map(t=>({raw:t,status:f(t),start:s(t.data.startDate),end:s(t.data.endDate)??s(t.data.startDate),isFeaturedFlag:!!t.data.featured})),d=e.filter(t=>t.status==="ongoing"),x=e.filter(t=>t.isFeaturedFlag&&t.start>o),h=new Map;for(const t of d)h.set(t.raw.id,t);for(const t of x)h.has(t.raw.id)||h.set(t.raw.id,t);const F=Array.from(h.values()).sort((t,n)=>t.start.getTime()-n.start.getTime()).map(t=>l(t.raw)),y=e.filter(t=>t.end>=o).sort((t,n)=>t.start.getTime()-n.start.getTime()).map(t=>l(t.raw)),M=e.filter(t=>t.end<o).sort((t,n)=>n.start.getTime()-t.start.getTime()).map(t=>l(t.raw)),E=y.reduce((t,n)=>{const g=n.data.startDate.getFullYear().toString();return t[g]=t[g]||[],t[g].push(n),t},{});return Object.keys(E).forEach(t=>{const n=E[t];n&&n.sort((g,R)=>g.data.startDate.getTime()-R.data.startDate.getTime())}),{featuredEvents:F,upcomingEvents:y,pastEvents:M,upcomingByYear:E}},[r,o]),S=(...e)=>e.filter(Boolean).join(" ");return a.jsxs("div",{className:S("flex flex-col gap-10",j),children:[i.length>0&&a.jsx(D,{id:"featured",title:"Featured Events",subtitle:"Highlighted events, including events happening right now",variant:"primary",children:a.jsx(T,{items:i,initialCount:p,viewAllText:`View All ${i.length} Featured & Current Events`,renderItem:e=>a.jsx(b,{eventId:e.id,data:e.data},e.id)})}),u.length>0&&a.jsx(D,{id:"upcoming",title:"Upcoming Events",subtitle:"Meet with the community at these future gatherings",variant:"secondary",children:a.jsx("div",{className:"flex flex-col gap-8",children:Object.keys(N).sort().map(e=>a.jsxs("div",{className:"mb-2",children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold mb-4 gradient-brand-text",children:e}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(N[e]??[]).map(d=>a.jsx(b,{eventId:d.id,data:d.data},d.id))})]},e))})}),w.length>0&&a.jsx(D,{id:"past",title:"Past Events",subtitle:"Explore our full archive of previous community events",variant:"tertiary",children:a.jsx(T,{items:w,initialCount:v,viewAllText:`View All ${w.length} Past Events`,renderItem:e=>a.jsx(b,{eventId:e.id,data:e.data},e.id)})})]})};export{q as default};
//# sourceMappingURL=EventsSections.CBe4JA-3.js.map
